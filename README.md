 🚦 智能交通信号灯控制系统 - 使用指南

 📋 现在你有的文件

1. `fixed_rl_traffic.py` - 你的原始交通系统代码
2. `integrated_traffic_system.py` - 新的集成版本（推荐使用）
3. `web_server.py` - 独立的Web监控服务器
4. 本README - 使用说明

 🚀 快速开始

 第一步：安装依赖

```bash
 基础依赖
pip install flask numpy

 深度学习依赖（可选，但推荐）
pip install torch

 CARLA已经假设你安装好了
```

 第二步：运行系统

方式1：直接运行集成版本（推荐）

```bash
python integrated_traffic_system.py
```

这会：
- 启动交通仿真
- 启动Web监控界面
- 自动打开训练模式

方式2：分别运行

```bash
 终端1：运行Web服务器
python web_server.py

 终端2：运行你的原始交通系统
python fixed_rl_traffic.py
```

 第三步：查看监控界面

打开浏览器，访问：
```
http://localhost:5000
```

你会看到实时的交通数据：
- 📊 车辆数量、平均速度、效率指标
- 🗺️ 各区域的详细状态
- 🤖 智能体的学习进度
- 🎓 训练控制按钮

 🎯 主要功能

 ✅ 实时监控
- 车辆统计: 总数、各区域分布
- 速度分析: 平均速度、区域速度
- 效率指标: 流动性、拥堵度、效率得分
- 智能体状态: 探索率、经验池、训练进度

 ✅ 可视化界面
- 状态面板: 系统运行状态一目了然
- 区域地图: 5个区域（中心、北、南、东、西）的实时数据
- 性能图表: 训练进度和性能指标
- 控制按钮: 开始/停止训练、保存模型

 ✅ 智能控制
- DQN算法: 深度强化学习优化信号灯
- 多种动作: 延长、切换、紧急、智能优化
- 自动训练: 达到目标后自动保存并停止
- 模型管理: 自动保存最佳模型

 📱 界面说明

 状态栏
```
[运行中] [28辆车] [29.1 km/h] [74%效率]
```

 性能指标卡片
- 流动性得分: 0.000-1.000 (越高越好)
- 效率得分: 0.000-1.000 (越高越好)  
- 拥堵比例: 0%-100% (越低越好)

 区域状态卡片
- 中心区: 🏙️ 车辆数 | 平均速度
- 北区: ⬆️ 车辆数 | 平均速度
- 南区: ⬇️ 车辆数 | 平均速度
- 东区: ➡️ 车辆数 | 平均速度
- 西区: ⬅️ 车辆数 | 平均速度

 智能体卡片
- 探索率: ε值，控制探索vs利用
- 经验池: 存储的经验数量
- 训练轮次: 已完成的训练回合
- 平均奖励: 最近的性能表现

 🔧 常见问题

 Q: Web界面显示"离线"怎么办？
A: 检查以下几点：
1. 确保CARLA服务器正在运行
2. 确保Python程序正在运行
3. 检查是否有防火墙阻止5000端口
4. 刷新浏览器页面

 Q: 没有看到车辆数据？
A: 可能原因：
1. CARLA地图中没有生成足够车辆
2. 数据收集线程没有启动
3. 等待几秒让系统初始化完成

 Q: 训练不开始？
A: 检查：
1. PyTorch是否正确安装
2. 查看控制台是否有错误信息
3. 确保CARLA连接正常

 Q: 想要修改训练目标？
A: 在代码中修改这些值：
```python
TARGET_EFFICIENCY = 0.75     目标效率
TARGET_MOBILITY = 0.80       目标流动性  
TARGET_REWARD = 0.50         目标平均奖励
MAX_EPISODES = 1000          最大训练轮数
```

 🎯 下一步改进建议

 1. 数据持久化
```python
 添加数据库支持
import sqlite3
 保存训练历史、性能数据
```

 2. 更多可视化
```python
 添加图表库
import plotly
 显示性能趋势图、实时图表
```

 3. 配置文件
```yaml
 config.yaml
training:
  target_efficiency: 0.75
  max_episodes: 1000
carla:
  host: localhost
  port: 2000
```

 4. API接口
```python
 添加RESTful API
@app.route('/api/start_training', methods=['POST'])
def start_training():
     通过API控制训练
```

 📞 技术支持

如果遇到问题：

1. 检查依赖: 确保Flask、numpy安装正确
2. 检查端口: 确保5000端口没被占用
3. 查看日志: 关注控制台输出的错误信息
4. 重启服务: 停止程序，重新启动CARLA和Python脚本